Sub GenerateAssignmentCounts()
    Dim wsData As Worksheet
    Dim wsOutput As Worksheet
    Dim lastRow As Long
    Dim assignCounts As Object, gmiCounts As Object, reasonCounts As Object
    Dim cell As Range
    Dim rowOutput As Long
    
    ' Set worksheets
    Set wsData = ThisWorkbook.Sheets("AssignedData") ' Sheet with the data
    Set wsOutput = ThisWorkbook.Sheets("Database") ' Sheet where the output will be written
    
    ' Find the last row in the AssignedData sheet
    lastRow = wsData.Cells(wsData.Rows.Count, "A").End(xlUp).Row
    
    ' Create dictionaries to store unique counts
    Set assignCounts = CreateObject("Scripting.Dictionary")
    Set gmiCounts = CreateObject("Scripting.Dictionary")
    Set reasonCounts = CreateObject("Scripting.Dictionary")
    
    ' Loop through each row in the data sheet
    For Each cell In wsData.Range("D2:D" & lastRow) ' D column = "ASSIGN" column
        ' Get values for each of the columns
        Dim assignPerson As String, gmiCustomer As String, reasonCode As String
        assignPerson = wsData.Cells(cell.Row, 10).Value ' "ASSIGN" column (column J)
        gmiCustomer = wsData.Cells(cell.Row, 3).Value ' "GMI CUSTOMER" column (column C)
        reasonCode = wsData.Cells(cell.Row, 4).Value ' "REASONCODE" column (column D)
        
        ' Count for "ASSIGN"
        If assignCounts.exists(assignPerson) Then
            assignCounts(assignPerson) = assignCounts(assignPerson) + 1
        Else
            assignCounts.Add assignPerson, 1
        End If
        
        ' Count for "GMI CUSTOMER"
        If gmiCounts.exists(gmiCustomer) Then
            gmiCounts(gmiCustomer) = gmiCounts(gmiCustomer) + 1
        Else
            gmiCounts.Add gmiCustomer, 1
        End If
        
        ' Count for "REASONCODE"
        If reasonCounts.exists(reasonCode) Then
            reasonCounts(reasonCode) = reasonCounts(reasonCode) + 1
        Else
            reasonCounts.Add reasonCode, 1
        End If
    Next cell
    
    ' Write the results to the "Database" sheet starting from E15
    
    ' Output for "ASSIGN" column counts
    rowOutput = 15
    wsOutput.Cells(rowOutput, 5).Value = "ASSIGN Person"
    wsOutput.Cells(rowOutput, 6).Value = "Unique Count"
    rowOutput = rowOutput + 1
    
    Dim key As Variant
    For Each key In assignCounts.keys
        wsOutput.Cells(rowOutput, 5).Value = key
        wsOutput.Cells(rowOutput, 6).Value = assignCounts(key)
        rowOutput = rowOutput + 1
    Next key
    
    ' Output for "GMI CUSTOMER" column counts
    rowOutput = 15
    wsOutput.Cells(rowOutput, 8).Value = "GMI CUSTOMER"
    wsOutput.Cells(rowOutput, 9).Value = "Unique Count"
    rowOutput = rowOutput + 1
    
    For Each key In gmiCounts.keys
        wsOutput.Cells(rowOutput, 8).Value = key
        wsOutput.Cells(rowOutput, 9).Value = gmiCounts(key)
        rowOutput = rowOutput + 1
    Next key
    
    ' Output for "REASONCODE" column counts
    rowOutput = 15
    wsOutput.Cells(rowOutput, 11).Value = "REASONCODE"
    wsOutput.Cells(rowOutput, 12).Value = "Unique Count"
    rowOutput = rowOutput + 1
    
    For Each key In reasonCounts.keys
        wsOutput.Cells(rowOutput, 11).Value = key
        wsOutput.Cells(rowOutput, 12).Value = reasonCounts(key)
        rowOutput = rowOutput + 1
    Next key
    
    MsgBox "Counts generated successfully.", vbInformation
End Sub
