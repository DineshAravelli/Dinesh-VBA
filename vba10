Sub ExtractAgreementID()
    Dim ie As Object
    Dim doc As Object
    Dim agreementID As String
    Dim url As String
    Dim ws As Worksheet
    Dim lastRow As Long
    
    ' Define the URL
    url = "https://myapps.fia-tech.com/Docs/#/agreement-view/906725" ' Change this URL if needed
    
    ' Create a new Internet Explorer instance (or Edge in IE mode)
    Set ie = CreateObject("InternetExplorer.Application")
    
    ' Set IE properties
    ie.Visible = False ' Set to True if you want to see the browser during execution
    ie.Navigate url
    
    ' Wait for the page to load completely
    Do While ie.Busy Or ie.ReadyState <> 4
        DoEvents
    Loop
    
    ' Get the document object
    Set doc = ie.Document
    
    ' Scrape the Agreement ID (located in the HTML structure)
    ' Modify this based on the actual HTML tag containing the Agreement ID
    agreementID = doc.getElementsByClassName("agreement-id")(0).innerText
    
    ' Set the worksheet where you want to save the Agreement ID (change "Sheet1" as necessary)
    Set ws = ThisWorkbook.Sheets("Sheet1")
    
    ' Find the last row in column A to append the new Agreement ID
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row + 1
    
    ' Write the Agreement ID to the next available row in column A
    ws.Cells(lastRow, 1).Value = agreementID
    
    ' Close Internet Explorer
    ie.Quit
    
    ' Inform the user
    MsgBox "Agreement ID " & agreementID & " has been saved to Excel.", vbInformation
End Sub
